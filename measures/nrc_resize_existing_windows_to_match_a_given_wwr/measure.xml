<?xml version="1.0"?>
<measure>
  <schema_version>3.0</schema_version>
  <name>nrc_resize_existing_windows_to_match_a_given_wwr</name>
  <uid>b1c8aae7-db36-4461-88f8-d6ac57ec11d5</uid>
  <version_id>4d2e025e-e312-4121-8e17-ba73dd4f32a8</version_id>
  <version_modified>20201203T162250Z</version_modified>
  <xml_checksum>A8B8B5E3</xml_checksum>
  <class_name>nrc_resize_existing_windows_to_match_a_given_wwr</class_name>
  <display_name>Resize existing windows to match a given WWR</display_name>
  <description>This measure aims to resize all of the existing windows in order to produce a specified, user-input, window to wall ratio.
The windows will be resized around their centroid.
It should be noted that this measure should work in all cases when DOWNSIZING the windows (which is often the need given the 40% WWR imposed as baseline by ASHRAE Appendix G).
If you aim to increase the area, please note that this could result in subsurfaces being larger than their parent surface</description>
  <modeler_description>The measure works in several steps:

1. Find the current Window to Wall Ratio (WWR).
This will compute the WWR by taking into account all of the surfaces that have all of the following characteristics:
- They are walls
- They have the outside boundary condition as 'Outdoors' (aims to not take into account the adiabatic surfaces)
- They are SunExposed (could be removed...)

2. Resize all of the existing windows by re-setting the vertices: scaled centered on centroid.

</modeler_description>
  <arguments>
    <argument>
      <name>remove_skylight</name>
      <display_name>Remove skylights?</display_name>
      <description></description>
      <type>Boolean</type>
      <units></units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>false</default_value>
      <choices>
        <choice>
          <value>true</value>
          <display_name>true</display_name>
        </choice>
        <choice>
          <value>false</value>
          <display_name>false</display_name>
        </choice>
      </choices>
      <min_value></min_value>
      <max_value></max_value>
    </argument>
    <argument>
      <name>cz_4_fdwr</name>
      <display_name>Climate zone 4 FDWR</display_name>
      <description></description>
      <type>Double</type>
      <units></units>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
      <min_value></min_value>
      <max_value></max_value>
    </argument>
    <argument>
      <name>cz_5_fdwr</name>
      <display_name>Climate zone 5 FDWR</display_name>
      <description></description>
      <type>Double</type>
      <units></units>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
      <min_value></min_value>
      <max_value></max_value>
    </argument>
    <argument>
      <name>cz_6_fdwr</name>
      <display_name>Climate zone 6 FDWR</display_name>
      <description></description>
      <type>Double</type>
      <units></units>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
      <min_value></min_value>
      <max_value></max_value>
    </argument>
    <argument>
      <name>cz_7A_fdwr</name>
      <display_name>Climate zone 7A FDWR</display_name>
      <description></description>
      <type>Double</type>
      <units></units>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
      <min_value></min_value>
      <max_value></max_value>
    </argument>
    <argument>
      <name>cz_7B_fdwr</name>
      <display_name>Climate zone 7B FDWR</display_name>
      <description></description>
      <type>Double</type>
      <units></units>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
      <min_value></min_value>
      <max_value></max_value>
    </argument>
    <argument>
      <name>cz_8_fdwr</name>
      <display_name>Climate zone 8 FDWR</display_name>
      <description></description>
      <type>Double</type>
      <units></units>
      <required>true</required>
      <model_dependent>false</model_dependent>
      <default_value>0</default_value>
      <min_value></min_value>
      <max_value></max_value>
    </argument>
    <argument>
      <name>check_wall</name>
      <display_name>Only affect surfaces that are "walls"?</display_name>
      <description></description>
      <type>Boolean</type>
      <units></units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>false</default_value>
      <choices>
        <choice>
          <value>true</value>
          <display_name>true</display_name>
        </choice>
        <choice>
          <value>false</value>
          <display_name>false</display_name>
        </choice>
      </choices>
      <min_value></min_value>
      <max_value></max_value>
    </argument>
    <argument>
      <name>check_outdoors</name>
      <display_name>Only affect surfaces that have boundary condition = "Outdoor"?</display_name>
      <description></description>
      <type>Boolean</type>
      <units></units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>true</default_value>
      <choices>
        <choice>
          <value>true</value>
          <display_name>true</display_name>
        </choice>
        <choice>
          <value>false</value>
          <display_name>false</display_name>
        </choice>
      </choices>
      <min_value></min_value>
      <max_value></max_value>
    </argument>
    <argument>
      <name>check_sunexposed</name>
      <display_name>Only affect surfaces that are "SunExposed"?</display_name>
      <description></description>
      <type>Boolean</type>
      <units></units>
      <required>false</required>
      <model_dependent>false</model_dependent>
      <default_value>true</default_value>
      <choices>
        <choice>
          <value>true</value>
          <display_name>true</display_name>
        </choice>
        <choice>
          <value>false</value>
          <display_name>false</display_name>
        </choice>
      </choices>
      <min_value></min_value>
      <max_value></max_value>
    </argument>
  </arguments>
  <outputs />
  <provenances />
  <tags>
    <tag>Envelope.Fenestration</tag>
  </tags>
  <attributes>
    <attribute>
      <name>Measure Type</name>
      <value>ModelMeasure</value>
      <datatype>string</datatype>
    </attribute>
    <attribute>
      <name>Intended Software Tool</name>
      <value>Apply Measure Now</value>
      <datatype>string</datatype>
    </attribute>
    <attribute>
      <name>Intended Software Tool</name>
      <value>OpenStudio Application</value>
      <datatype>string</datatype>
    </attribute>
    <attribute>
      <name>Intended Software Tool</name>
      <value>Parametric Analysis Tool</value>
      <datatype>string</datatype>
    </attribute>
    <attribute>
      <name>Intended Use Case</name>
      <value>New Construction EE</value>
      <datatype>string</datatype>
    </attribute>
    <attribute>
      <name>Intended Use Case</name>
      <value>Retrofit EE</value>
      <datatype>string</datatype>
    </attribute>
  </attributes>
  <files>
    <file>
      <filename>README.md.erb</filename>
      <filetype>erb</filetype>
      <usage_type>readmeerb</usage_type>
      <checksum>703C9964</checksum>
    </file>
    <file>
      <filename>example_model.osm</filename>
      <filetype>osm</filetype>
      <usage_type>test</usage_type>
      <checksum>53D14E69</checksum>
    </file>
    <file>
      <filename>warehouse_2017.osm</filename>
      <filetype>osm</filetype>
      <usage_type>test</usage_type>
      <checksum>D3EA641F</checksum>
    </file>
    <file>
      <filename>README.md</filename>
      <filetype>md</filetype>
      <usage_type>readme</usage_type>
      <checksum>0B68E96D</checksum>
    </file>
    <file>
      <filename>BTAPMeasureHelper.rb</filename>
      <filetype>rb</filetype>
      <usage_type>resource</usage_type>
      <checksum>F05DC3DD</checksum>
    </file>
    <file>
      <filename>NRCMeasureHelper.rb</filename>
      <filetype>rb</filetype>
      <usage_type>resource</usage_type>
      <checksum>2EBA603D</checksum>
    </file>
    <file>
      <filename>test.rb</filename>
      <filetype>rb</filetype>
      <usage_type>test</usage_type>
      <checksum>CA6D57CC</checksum>
    </file>
    <file>
      <version>
        <software_program>OpenStudio</software_program>
        <identifier>1.8.0</identifier>
        <min_compatible>1.8.0</min_compatible>
      </version>
      <filename>measure.rb</filename>
      <filetype>rb</filetype>
      <usage_type>script</usage_type>
      <checksum>BFB084B1</checksum>
    </file>
    <file>
      <filename>FullServiceRestaurant_Edmonton.osm</filename>
      <filetype>osm</filetype>
      <usage_type>test</usage_type>
      <checksum>2F3ABF34</checksum>
    </file>
  </files>
</measure>
<error>undefined method `empty?' for NrcResizeExistingWindowsToMatchAGivenWWR:Class</error>
